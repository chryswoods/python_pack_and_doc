

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Packaging releases &mdash; Pack and Doc Documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script src="_static/custom.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Developer’s guide" href="development.html" />
    <link rel="prev" title="Roadmap" href="roadmap.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> Pack and Doc
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
  <div id="version_box"></div>
</div>


          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="features.html">Features</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation instructions</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="quickstart/index.html">Quick Start</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorial/index.html">Tutorial</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="support.html">Help and support</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="devsupport.html">Developer Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="roadmap.html">Roadmap</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Packaging releases</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#defining-a-release">Defining a release</a></li>
<li class="toctree-l2"><a class="reference internal" href="#creating-a-release">Creating a release</a></li>
<li class="toctree-l2"><a class="reference internal" href="#testing-the-packages">Testing the packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tagging-a-new-release">Tagging a new release</a></li>
<li class="toctree-l2"><a class="reference internal" href="#uploading-packages-to-pypi">Uploading packages to pypi</a></li>
<li class="toctree-l2"><a class="reference internal" href="#testing-the-final-release">Testing the final release</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="development.html">Developer’s guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/index.html">Documentation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="acknowledgements.html">Acknowledgements</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Pack and Doc</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Packaging releases</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="development.html" class="btn btn-neutral float-right" title="Developer’s guide" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="roadmap.html" class="btn btn-neutral float-left" title="Roadmap" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="packaging-releases">
<h1>Packaging releases<a class="headerlink" href="#packaging-releases" title="Permalink to this headline">¶</a></h1>
<p>Pack and Doc is now fully tested and deployed using GitHub actions.
The development process should be;</p>
<ul class="simple">
<li><p>New features are developed on feature branches, called <code class="docutils literal notranslate"><span class="pre">feature-{feature}</span></code>,
either in the <a class="reference external" href="https://github.com/chryswoods/python_pack_and_doc">main Pack and Doc repository</a>
for authorised developers, or in personal forks for
new developers.</p></li>
<li><p>Bug fixes or issue fixes are developed on fix branches, called
<code class="docutils literal notranslate"><span class="pre">fix-issue-{number}</span></code> (again in either the main repository or forks).</p></li>
<li><p>Pull requests are issued from these branches to <code class="docutils literal notranslate"><span class="pre">devel</span></code>. All merge conflicts
must be fixed in the branch and all tests must pass before the pull
request can be merged into <code class="docutils literal notranslate"><span class="pre">devel</span></code>.</p></li>
</ul>
<p>The result of this is that “devel” should contain the fully-working and
tested, and most up-to-date version of <code class="docutils literal notranslate"><span class="pre">pack</span> <span class="pre">and</span> <span class="pre">doc</span></code>. However, this
version should not be used for production runs.</p>
<div class="section" id="defining-a-release">
<h2>Defining a release<a class="headerlink" href="#defining-a-release" title="Permalink to this headline">¶</a></h2>
<p>We will release <code class="docutils literal notranslate"><span class="pre">pack</span> <span class="pre">and</span> <span class="pre">doc</span></code> regularly. Releases aim to be backwards
compatible and capable of being used for production runs, at least for
the functionality that is fully described in the tutorial.</p>
<p>We use <a class="reference external" href="https://semver.org">semantic versioning</a> and take care
not to cause breaking changes in the public API.</p>
</div>
<div class="section" id="creating-a-release">
<h2>Creating a release<a class="headerlink" href="#creating-a-release" title="Permalink to this headline">¶</a></h2>
<p>To create a release first checkout the “main” branch.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git checkout main
git pull
</pre></div>
</div>
<p>Next, merge in all changes from the “devel” branch.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git pull origin devel
</pre></div>
</div>
<p>Next, update the <a class="reference internal" href="changelog.html"><span class="doc">Changelog</span></a> with details about this release. This
should include the link at the top of the release that shows the commit
differences between versions. This can be easily copied from a previous
release and updated, e.g.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>`0.11.2 &lt;https://github.com/metawards/MetaWards/compare/0.11.1...0.11.2&gt;`__ - May 11th 2020
</pre></div>
</div>
<p>could be changed to</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>`0.12.0 &lt;https://github.com/metawards/MetaWards/compare/0.11.2...0.12.0&gt;`__ - May 18th 2020
</pre></div>
</div>
<p>when moving from the 0.11.2 to 0.12.0 release.</p>
<p>Now push this change back to GitHub, using;</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git push
</pre></div>
</div>
<p>This will trigger a CI/CD run which will build and test everything on
Windows, Mac and Linux for Python 3.7 and 3.8. Everything should work,
as “devel” should have been in a release-ready state.</p>
</div>
<div class="section" id="testing-the-packages">
<h2>Testing the packages<a class="headerlink" href="#testing-the-packages" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/metawards/MetaWards/actions">GitHub actions</a> will
produce the source and binary wheels for <code class="docutils literal notranslate"><span class="pre">metawards</span></code> on all supported
platforms. This will be in an artifact called <code class="docutils literal notranslate"><span class="pre">dist</span></code> which you should
download and unpack.</p>
<img alt="Image of the GitHub Actions interface showing the dist artifact" src="images/github_artifacts.jpg" />
<p>You should unpack these into the <code class="docutils literal notranslate"><span class="pre">dist</span></code> directory, e.g.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> dist
unzip ~/Downloads/dist.zip
</pre></div>
</div>
<p>This should result in six binary wheels and once source package, e.g.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">metawards</span><span class="o">-</span><span class="mf">0.11</span><span class="o">.</span><span class="mi">1</span><span class="o">+</span><span class="mf">7.</span><span class="n">g52b3671</span><span class="o">-</span><span class="n">cp37</span><span class="o">-</span><span class="n">cp37m</span><span class="o">-</span><span class="n">macosx_10_14_x86_64</span><span class="o">.</span><span class="n">whl</span>
<span class="n">metawards</span><span class="o">-</span><span class="mf">0.11</span><span class="o">.</span><span class="mi">1</span><span class="o">+</span><span class="mf">7.</span><span class="n">g52b3671</span><span class="o">-</span><span class="n">cp37</span><span class="o">-</span><span class="n">cp37m</span><span class="o">-</span><span class="n">manylinux1_x86_64</span><span class="o">.</span><span class="n">whl</span>
<span class="n">metawards</span><span class="o">-</span><span class="mf">0.11</span><span class="o">.</span><span class="mi">1</span><span class="o">+</span><span class="mf">7.</span><span class="n">g52b3671</span><span class="o">-</span><span class="n">cp37</span><span class="o">-</span><span class="n">cp37m</span><span class="o">-</span><span class="n">win_amd64</span><span class="o">.</span><span class="n">whl</span>
<span class="n">metawards</span><span class="o">-</span><span class="mf">0.11</span><span class="o">.</span><span class="mi">1</span><span class="o">+</span><span class="mf">7.</span><span class="n">g52b3671</span><span class="o">-</span><span class="n">cp38</span><span class="o">-</span><span class="n">cp38</span><span class="o">-</span><span class="n">macosx_10_14_x86_64</span><span class="o">.</span><span class="n">whl</span>
<span class="n">metawards</span><span class="o">-</span><span class="mf">0.11</span><span class="o">.</span><span class="mi">1</span><span class="o">+</span><span class="mf">7.</span><span class="n">g52b3671</span><span class="o">-</span><span class="n">cp38</span><span class="o">-</span><span class="n">cp38</span><span class="o">-</span><span class="n">manylinux1_x86_64</span><span class="o">.</span><span class="n">whl</span>
<span class="n">metawards</span><span class="o">-</span><span class="mf">0.11</span><span class="o">.</span><span class="mi">1</span><span class="o">+</span><span class="mf">7.</span><span class="n">g52b3671</span><span class="o">-</span><span class="n">cp38</span><span class="o">-</span><span class="n">cp38</span><span class="o">-</span><span class="n">win_amd64</span><span class="o">.</span><span class="n">whl</span>
<span class="n">metawards</span><span class="o">-</span><span class="mf">0.11</span><span class="o">.</span><span class="mi">1</span><span class="o">+</span><span class="mf">7.</span><span class="n">g52b3671</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
</pre></div>
</div>
<p>Try to install the package related to you machine, just to double-check
that it is working, e.g.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install ./metawards-0.11.1+7.g52b3671-cp37-cp37m-macosx_10_14_x86_64.whl
<span class="nb">cd</span> ..
pytest tests
</pre></div>
</div>
<p>Once it is working, remove these temporary packages from your <code class="docutils literal notranslate"><span class="pre">dist</span></code> folder,</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>rm dist/*
</pre></div>
</div>
</div>
<div class="section" id="tagging-a-new-release">
<h2>Tagging a new release<a class="headerlink" href="#tagging-a-new-release" title="Permalink to this headline">¶</a></h2>
<p>Now that you are happy that the release is ready, you can tag the new
version. Do this using the <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">tag</span></code> command, e.g.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git tag -a <span class="o">{</span>VERSION<span class="o">}</span> -m <span class="s2">&quot;{VERSION} release&quot;</span>
</pre></div>
</div>
<p>replacing <code class="docutils literal notranslate"><span class="pre">{VERSION}</span></code> with the version number. For this 0.12.0 release
the command would be;</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git tag -a <span class="m">0</span>.12.0 -m <span class="s2">&quot;0.12.0 release&quot;</span>
</pre></div>
</div>
<p>Next, push your tag to GitHub;</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git push --tags
</pre></div>
</div>
<p>The tag will be used by automatic versioning script to generate
the version numbers of the code. Building the package
(as happens below) will automatically update the _version.py
that is included in the package to tag versions.</p>
<p>This will also trigger a full CI/CD to test and build the new version.
Again, it should work as this tag was taken from your fully-tested
“main” branch.</p>
</div>
<div class="section" id="uploading-packages-to-pypi">
<h2>Uploading packages to pypi<a class="headerlink" href="#uploading-packages-to-pypi" title="Permalink to this headline">¶</a></h2>
<p>While you are waiting for the CI/CD GitHub Actions to complete, make sure
that your version of twine is fully up to date;</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install --upgrade twine
</pre></div>
</div>
<p>Once GitHub actions is complete, you will see that another build artifact
is ready for download. Download this and unpack it into your <code class="docutils literal notranslate"><span class="pre">dist</span></code>
directory as before. You should now have a <code class="docutils literal notranslate"><span class="pre">dist</span></code> directory that
contains six binary wheels and one source package, named according to
the release version. For example, for the 0.11.2 release we had;</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ ls dist
 metawards-0.11.2-cp37-cp37m-macosx_10_14_x86_64.whl
 metawards-0.11.2-cp37-cp37m-manylinux1_x86_64.whl
 metawards-0.11.2-cp37-cp37m-win_amd64.whl
 metawards-0.11.2-cp38-cp38-macosx_10_14_x86_64.whl
 metawards-0.11.2-cp38-cp38-manylinux1_x86_64.whl
 metawards-0.11.2-cp38-cp38-win_amd64.whl
 metawards-0.11.2.tar.gz
</pre></div>
</div>
<p>Now you can upload to pypi using the command;</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3 -m twine upload dist/*
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You will need a username and password for pypi and to have
permission to upload code to this project. Currently only
the release manager has permission. If you would like
join the release management team then please get in touch.</p>
</div>
</div>
<div class="section" id="testing-the-final-release">
<h2>Testing the final release<a class="headerlink" href="#testing-the-final-release" title="Permalink to this headline">¶</a></h2>
<p>Finally(!) test the release on a range of different machines by logging
in and typing;</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install <span class="nv">metawards</span><span class="o">=={</span>VERSION<span class="o">}</span>
</pre></div>
</div>
<p>replacing <code class="docutils literal notranslate"><span class="pre">{VERSION}</span></code> with the version number, e.g. for 0.11.2</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install <span class="nv">metawards</span><span class="o">==</span><span class="m">0</span>.11.2
</pre></div>
</div>
<p>Play with the code, run the tests and run some examples. Everything should
work as you have performed lots of prior testing to get to this stage.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="development.html" class="btn btn-neutral float-right" title="Developer’s guide" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="roadmap.html" class="btn btn-neutral float-left" title="Roadmap" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
      <span class="lastupdated">
        Last updated on Sep 23, 2020.
      </span>

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>